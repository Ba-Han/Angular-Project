<div class="flex flex-col w-full" style="background:#fff;">

    <!-- View mode -->
    <ng-container *ngIf="!editMode && !pointlistMode && !transactionlistMode && !pointDetailViewMode && !pointDetailEditMode && !pointDetailAddMode && !transactionDetailMode">
        <!-- Header -->
        <div class="relative w-full px-8 sm:px-12 bg-accent-100 dark:bg-accent-700">
            <!-- Close button -->
            <div class="flex items-center justify-end w-full max-w-3xl mx-auto pt-6">
                <button mat-icon-button
                        [matTooltip]="'Close'"
                        [routerLink]="['../']"
                        (click)="closeDrawer()" style="background:gray;">
                    <mat-icon class="text-white"
                              [svgIcon]="'heroicons_outline:x'"></mat-icon>
                </button>
            </div>
        </div>

        <!-- member -->
        <div class="relative flex flex-col flex-auto items-center p-6 pt-0 sm:p-12 sm:pt-0">
            <div class="w-full max-w-3xl">

                <!-- Avatar and actions -->
                <div class="flex flex-auto items-end py-5 -mt-16">
                    <!-- Avatar -->
                    <div class="flex items-center justify-center w-32 h-32 rounded-full overflow-hidden ring-4 ring-bg-card">

                        <div class="flex items-center justify-center w-full h-full rounded overflow-hidden uppercase text-8xl font-bold leading-none bg-gray-200 text-gray-600 dark:bg-gray-700 dark:text-gray-200"
                             >
                            {{member.member[0].first_name.charAt(0)}}
                        </div>
                    </div>
                    <!-- Actions -->
                    <div class="flex items-center h-20 ml-5 mb-1">

                        <button mat-stroked-button
                                (click)="toggleEditMode(true)">
                            <mat-icon class="icon-size-5"
                                      [svgIcon]="'heroicons_solid:pencil-alt'"></mat-icon>
                            <span class="ml-2">Edit</span>
                        </button>

                        <!--<button mat-stroked-button
                                (click)="toggleEditMode(true)">
                            <mat-icon class="icon-size-5"
                                      [svgIcon]="'heroicons_solid:pencil-alt'"></mat-icon>
                            <span class="ml-2">Edit Address</span>
                        </button>-->

                    </div>
                </div>

                <div class="grid grid-cols-2">
                    <!-- Name -->
                    <div class="text-4xl font-bold" style="word-break: break-word;white-space: normal;">
                        {{member.member[0].first_name}} {{member.member[0].last_name}}
                        <ng-container *ngIf="member.member[0].gender === 'male'">
                            <mat-icon svgIcon="mat_outline:male"></mat-icon>
                        </ng-container>
                        <ng-container *ngIf="member.member[0].gender === 'female'">
                            <mat-icon svgIcon="mat_outline:female"></mat-icon>
                        </ng-container>
                    </div>
                    <div class="gap-5">
                        <!--<div class="text-2xl font-bold bg-blue-100 text-left rounded-full py-3 px-6"> <mat-icon [svgIcon]="'heroicons_outline:sparkles'"></mat-icon> Repeat Purchasers </div>-->
                        <div class="text-2xl font-bold bg-blue-100 text-left rounded-full py-3 px-6"> <mat-icon [svgIcon]="'heroicons_outline:academic-cap'"></mat-icon> {{member.member[0].member_tier.name}} </div>
                    </div>
                </div>
            </div>

            <div class="w-full grid memberdetail-grid gap-6 mt-4 pt-5 border-t">

                <div class="bg-card shadow rounded-2xl">
                    <div class="flex p-2">
                        <mat-icon svgIcon="heroicons_solid:information-circle"></mat-icon>
                        <div class="font-bold ml-2 leading-6 text-2xl">Basic Information</div>
                    </div>

                    <ng-container *ngIf="member.member[0].member_code">
                        <div class="flex p-2">
                            <mat-icon [svgIcon]="'mat_solid:card_membership'" class="icon-size-5"></mat-icon>
                            <div class="font-bold ml-2 leading-6 w-2/4">  Member Code : </div>
                            <div class="ml-2 leading-6 w-3/4">{{member.member[0].member_code}}</div>
                        </div>
                    </ng-container>

                    <ng-container *ngIf="member.member[0].card_no">
                        <div class="flex p-2">
                            <mat-icon [svgIcon]="'heroicons_outline:credit-card'" class="icon-size-5"></mat-icon>
                            <div class="font-bold ml-2 leading-6 w-2/4">  Card No : </div>
                            <div class="ml-2 leading-6 w-3/4">{{member.member[0].card_no}}</div>
                        </div>
                    </ng-container>

                    <ng-container *ngIf="member.member[0].mobile_phone">
                        <div class="flex p-2">
                            <mat-icon [svgIcon]="'mat_solid:phone'" class="icon-size-5"></mat-icon>
                            <div class="font-bold ml-2 leading-6 w-2/4">  Mobile Phone : </div>
                            <div class="ml-2 leading-6 w-3/4">{{member.member[0].mobile_phone}}</div>
                        </div>
                    </ng-container>

                    <ng-container *ngIf="member.member[0].email">
                        <div class="flex p-2">
                            <mat-icon [svgIcon]="'mat_solid:mail'" class="icon-size-5"></mat-icon>
                            <div class="font-bold ml-2 leading-6 w-2/4">  Email : </div>
                            <div class="ml-2 leading-6 w-3/4">{{member.member[0].email}}</div>
                        </div>
                    </ng-container>

                    <ng-container *ngIf="member.member[0].date_of_birth">
                        <div class="flex p-2">
                            <mat-icon [svgIcon]="'mat_solid:cake'" class="icon-size-5"></mat-icon>
                            <div class="font-bold ml-2 leading-6 w-2/4">  Birthday : </div>
                            <div class="ml-2 leading-6 w-3/4">{{member.member[0].date_of_birth | date:'MMM dd, y'}}</div>
                        </div>
                    </ng-container>

                    <ng-container *ngIf="member.member[0].gender">
                        <div class="flex p-2">
                            <ng-container *ngIf="member.member[0].gender.toLowerCase() === 'male' || member.member[0].gender === '1'">
                                <mat-icon svgIcon="mat_solid:male" class="icon-size-5"></mat-icon>
                            </ng-container>
                            <ng-container *ngIf="member.member[0].gender.toLowerCase() === 'female' || member.member[0].gender === '2'">
                                <mat-icon svgIcon="mat_solid:female" class="icon-size-5"></mat-icon>
                            </ng-container>
                            <div class="font-bold ml-2 leading-6 w-2/4">  Gender : </div>
                            <div class="ml-2 leading-6 w-3/4">{{member.member[0].gender}}</div>
                        </div>
                    </ng-container>
                    <ng-container *ngIf="member.member[0].accept_email">
                        <div class="flex p-2">
                            <mat-icon svgIcon="heroicons_solid:mail-open" class="icon-size-5"></mat-icon>
                            <div class="font-bold ml-2 leading-6 w-2/4">  Allow Email : </div>
                            <ng-container *ngIf="member.member[0].accept_email === true">
                                <div class="ml-2 leading-6 w-3/4">Yes</div>
                            </ng-container>
                            <ng-container *ngIf="member.member[0].accept_email === false">
                                <div class="ml-2 leading-6 w-3/4">No</div>
                            </ng-container>

                        </div>
                    </ng-container>
                    <ng-container *ngIf="member.member[0].accept_mobile_sms">
                        <div class="flex p-2">
                            <mat-icon svgIcon="heroicons_solid:chat-alt" class="icon-size-5"></mat-icon>
                            <div class="font-bold ml-2 leading-6 w-2/4">  Allow SMS : </div>
                            <ng-container *ngIf="member.member[0].accept_mobile_sms === true">
                                <div class="ml-2 leading-6 w-3/4">Yes</div>
                            </ng-container>
                            <ng-container *ngIf="member.member[0].accept_mobile_sms === false">
                                <div class="ml-2 leading-6 w-3/4">No</div>
                            </ng-container>
                        </div>
                    </ng-container>

                    <ng-container *ngIf="member.member[0].registration_date">
                        <div class="flex p-2">
                            <mat-icon svgIcon="heroicons_solid:clipboard-check" class="icon-size-5"></mat-icon>
                            <div class="font-bold ml-2 leading-6 w-2/4">  Registeration Date : </div>
                            <div class="ml-2 leading-6 w-3/4">{{member.member[0].registration_date | date:'MMM dd, y'}}</div>
                        </div>
                    </ng-container>

                    <ng-container *ngIf="member.member[0].registration_channel">
                        <div class="flex p-2">
                            <mat-icon svgIcon="heroicons_solid:server" class="icon-size-5"></mat-icon>
                            <div class="font-bold ml-2 leading-6 w-2/4">  Registeration Channel : </div>
                            <div class="ml-2 leading-6 w-3/4">{{member.member[0].registration_channel}}</div>
                        </div>
                    </ng-container>

                    <ng-container *ngIf="member.member[0].store">
                        <div class="flex p-2">
                            <mat-icon svgIcon="heroicons_solid:library" class="icon-size-5"></mat-icon>
                            <div class="font-bold ml-2 leading-6 w-2/4">  Store : </div>
                            <div class="ml-2 leading-6 w-3/4">{{member.member[0].store}}</div>
                        </div>
                    </ng-container>
                </div>

                <div class="flex flex-col flex-auto ">

                    <!-- Earning Row -->
                    <div class="fpx-5 bg-card overflow-hidden" style="margin-bottom:10px; margin-bottom:10px;padding:1px;">
                        <div class="fpx-5 bg-card shadow rounded-2xl overflow-hidden" style="margin-bottom:10px;width:48%;float:left">
                            <div class="flex items-start justify-between">
                                <div class="text-lg font-medium tracking-tight leading-6 truncate"></div>
                                <div class="ml-2 -mt-2 -mr-3">
                                </div>
                            </div>
                            <div class="flex flex-col items-center mt-2 justify-center h-40">
                                <div class="text-7xl sm:text-4xl font-bold tracking-tight leading-none text-blue-500">{{member.spending.totalPoint}}</div>
                                <div class="text-lg font-mediu text-blue-600 dark:text-blue-500">Current/Redeemable Points</div>
                                <ng-container *ngIf="member.soonExpiredPoint.soonExpiredPoints > 0">
                                    <div class="items-baseline justify-center w-full mt-4 text-secondary">
                                        <div class="flex justify-center truncate w-full font-bold" style="font-size: 14px;">Points to expire soon</div>
                                        <div class="text-md font-medium flex justify-center truncate" style="font-size: 12px;">Expire Points:
                                            <ng-container *ngIf="member.soonExpiredPoint.soonExpiredPoints > 0">
                                                <div class="ml-1.5 font-semibold" style="font-size: 12px;">{{member.soonExpiredPoint.soonExpiredPoints}}</div>
                                            </ng-container>
                                        </div>
                                        
                                        <ng-container *ngIf="member.soonExpiredPoint.soonExpiredPoints == 0">
                                            <div class="ml-1.5 font-semibold">-</div>
                                        </ng-container>
                                    </div>
                                    <div class="flex items-baseline justify-center w-full text-secondary">
                                    <div class="text-md font-medium truncate" style="font-size: 12px;">Expire Date:</div>
                                    <ng-container *ngIf="member.soonExpiredPoint.soonExpiredPoints > 0">
                                        <div class="ml-1.5 font-semibold" style="font-size: 12px;">{{member.soonExpiredPoint.soonExpiredDate | date:'MMM dd, yyyy'}}</div>
                                    </ng-container>
                                    <ng-container *ngIf="member.soonExpiredPoint.soonExpiredPoints == 0">
                                        <div class="ml-1.5 font-semibold">-</div>
                                    </ng-container>
                                </div>
                                </ng-container>
                            </div>
                        </div>
                        <div class="fpx-5 bg-card shadow rounded-2xl overflow-hidden" style="margin-bottom:10px;width:50%;float:right">
                            <div class="flex items-start justify-between">
                                <div class="text-lg font-medium tracking-tight leading-6 truncate"></div>
                                <div class="ml-2 -mt-2 -mr-3">
                                </div>
                            </div>
                            <div class="flex flex-col items-center mt-2 justify-center h-40">
                                <div class="text-7xl sm:text-4xl font-bold tracking-tight leading-none text-blue-500">${{member.spending.dollerValueSpending | number : '1.2-2'}}</div>
                                <div class="text-lg font-medium text-blue-600 dark:text-blue-500">Current/Redeemable Dollar</div>
                                <ng-container *ngIf="member.soonExpiredPoint.soonExpiredDollars > 0">
                                    <div class="items-baseline justify-center w-full mt-4 text-secondary">
                                        <div class="flex justify-center truncate w-full font-bold" style="font-size: 14px;">Dollars to expire soon</div>
                                        <div class="text-md font-medium flex justify-center truncate" style="font-size: 12px;">Expire Dollars:
                                            <ng-container *ngIf="member.soonExpiredPoint.soonExpiredDollars > 0">
                                                <div class="ml-1.5 font-semibold" style="font-size: 12px;">${{member.soonExpiredPoint.soonExpiredDollars}}</div>
                                            </ng-container>
                                            <ng-container *ngIf="member.soonExpiredPoint.soonExpiredDollars == 0">
                                                <div class="ml-1.5 font-semibold">-</div>
                                            </ng-container>
                                        </div>
                                    </div>
                                    <div class="flex items-baseline justify-center w-full text-secondary">
                                    <div class="text-md font-medium truncate" style="font-size: 12px;">Expire Date:</div>
                                    <ng-container *ngIf="member.soonExpiredPoint.soonExpiredDollars > 0">
                                        <div class="ml-1.5 font-semibold" style="font-size: 12px;">{{member.soonExpiredPoint.soonExpiredDate | date:'MMM dd, y'}}</div>
                                    </ng-container>
                                    <ng-container *ngIf="member.soonExpiredPoint.soonExpiredDollars == 0">
                                        <div class="ml-1.5 font-semibold">-</div>
                                    </ng-container>
                                </div>
                                </ng-container>
                            </div>
                        </div>
                    </div>

                    <!-- Dollar Row -->
                    <div class="bg-card overflow-hidden" style="margin-bottom:10px; margin-bottom:10px;padding:1px;">
                        <div class="bg-card shadow rounded-2xl overflow-hidden" style="margin-bottom:10px;width:48%;float:left">
                            <div class="flex items-start justify-between">
                                <div class="text-lg font-medium tracking-tight leading-6 truncate"></div>
                                <div class="ml-2 -mt-2 -mr-3">
                                </div>
                            </div>
                            <div class="flex flex-col items-center justify-center h-30">
                                <div class="flex flex-col items-center">
                                    <div class="text-7xl sm:text-4xl font-bold tracking-tight leading-none text-blue-500">{{ ((member.earning.redeemTotalPoint) ? member.earning.redeemTotalPoint : 0)}}</div>
                                    <div class="text-lg font-medium text-blue-600 dark:text-blue-500">Total Redeemed Points</div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-card shadow rounded-2xl overflow-hidden" style="margin-bottom:10px;width:50%;float:right">
                            <div class="flex items-start justify-between">
                                <div class="text-lg font-medium tracking-tight leading-6 truncate"></div>
                                <div class="ml-2 -mt-2 -mr-3">
                                </div>
                            </div>

                            <div class="flex flex-col items-center justify-center h-30">
                                <div class="flex flex-col items-center">
                                    <div class="text-7xl sm:text-4xl font-bold tracking-tight leading-none text-blue-500">${{member.earning.dollerValueRedeem | number : '1.2-2'}} </div>
                                    <div class="text-lg font-medium text-blue-600 dark:text-blue-500">Total Redeemed Dollars</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!--Expire Row -->
                    <div class="bg-card overflow-hidden" style="padding:1px;">
                        <div class="bg-card shadow rounded-2xl overflow-hidden" style="width:48%;float:left">
                            <div class="flex items-start justify-between">
                                <div class="text-lg font-medium tracking-tight leading-6 truncate"></div>
                                <div class="ml-2 -mt-2 -mr-3">
                                </div>
                            </div>
                            <div class="flex flex-col items-center justify-center h-30">
                                <div class="flex flex-col items-center">
                                    <!-- <div class="text-7xl sm:text-4xl font-bold tracking-tight leading-none text-blue-500">{{ ((member.spending.expiredTotalPoints) ? member.earning.expiredTotalPoints : 0)}}</div> -->
                                    <div class="text-7xl sm:text-4xl font-bold tracking-tight leading-none text-blue-500">{{((member.spending.expiredTotalPoints))}}</div>
                                    <div class="text-lg font-medium text-blue-600 dark:text-blue-500">Total Expired Points</div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-card shadow rounded-2xl overflow-hidden" style="width:50%;float:right">
                            <div class="flex items-start justify-between">
                                <div class="text-lg font-medium tracking-tight leading-6 truncate"></div>
                                <div class="ml-2 -mt-2 -mr-3">
                                </div>
                            </div>

                            <div class="flex flex-col items-center justify-center h-30">
                                <div class="flex flex-col items-center">
                                    <div class="text-7xl sm:text-4xl font-bold tracking-tight leading-none text-blue-500">${{member.spending.dollerValueSpendingExpired | number : '1.2-2'}} </div>
                                    <div class="text-lg font-medium text-blue-600 dark:text-blue-500">Total Expired Dollars</div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>


                <!-- Recent member points table -->
                <div class="col-span-2 flex flex-col flex-auto bg-card shadow rounded-2xl overflow-hidden">
                    <div class="p-6">
                        <div class="mr-4 text-lg font-medium tracking-tight leading-6 truncate">Recent member points</div>
                    </div>
                    <div class="overflow-x-auto mx-6">
                        <table class="w-full bg-transparent"
                               mat-table
                               matSort
                               [dataSource]="recentPointsDataSource"
                               [trackBy]="trackByFn"
                               #recentPointsTable>

                            <!-- Document No. -->
                            <ng-container matColumnDef="transaction_document_no">
                                <th mat-header-cell
                                    mat-sort-header
                                    *matHeaderCellDef style="background:#e2e8f0;">
                                    Document No.
                                </th>
                                <td mat-cell [routerLink]="['./memberpoint', point.id]" style="cursor:pointer;"
                                    *matCellDef="let point">
                                    <span class="pr-6 font-medium text-sm text-secondary whitespace-nowrap">
                                        {{point.transaction_document_no}}
                                    </span>

                                </td>

                            </ng-container>
                             
                            <!-- Type -->
                            <ng-container matColumnDef="point_type">
                                <th mat-header-cell
                                    mat-sort-header
                                    *matHeaderCellDef style="background:#e2e8f0;">
                                    Point Type
                                </th>
                                <td mat-cell [routerLink]="['./memberpoint', point.id]" style="cursor:pointer;"
                                    *matCellDef="let point">
                                    <span class="pr-6 whitespace-nowrap" style="text-transform:capitalize;">
                                        {{point.point_type}}
                                    </span>
                                </td>
                            </ng-container>

                            <!-- Point -->
                            <ng-container matColumnDef="point">
                                <th mat-header-cell
                                    mat-sort-header
                                    *matHeaderCellDef style="background:#e2e8f0;">
                                    Points
                                </th>
                                <td mat-cell [routerLink]="['./memberpoint', point.id]" style="cursor:pointer;"
                                    *matCellDef="let point">
                                    <span class="pr-6 font-medium whitespace-nowrap">
                                        {{point.point}}
                                    </span>
                                </td>
                            </ng-container>

                            <!-- Dollar Value -->
                            <ng-container matColumnDef="pointsInDoller">
                                <th mat-header-cell
                                    mat-sort-header
                                    *matHeaderCellDef style="background:#e2e8f0;">
                                    $ Value
                                </th>
                                <td mat-cell [routerLink]="['./memberpoint', point.id]" style="cursor:pointer;"
                                    *matCellDef="let point">
                                    <span class="pr-6 font-medium whitespace-nowrap">
                                        ${{point.pointsInDollar | number : '1.2-2'}}
                                    </span>
                                </td>
                            </ng-container>

                            <!-- Footer -->

                            <ng-container *ngIf="transactions.length > 0">
                                <ng-container matColumnDef="recentPointsTableFooter">
                                    <td class="py-6 px-0 border-0"
                                        mat-footer-cell
                                        *matFooterCellDef
                                        colspan="4">
                                        <button mat-stroked-button
                                                [routerLink]="['./memberpoint']">
                                            See all member points
                                        </button>
                                    </td>
                                </ng-container>
                            </ng-container>

                            <ng-container *ngIf="transactions.length == 0">
                                <ng-container matColumnDef="recentPointsTableFooter">
                                    <td class="py-6 px-0 border-0"
                                        mat-footer-cell
                                        *matFooterCellDef
                                        colspan="4"
                                        style="color:grey;">
                                        <button mat-stroked-button
                                                [routerLink]="['./memberpoint']">
                                            See all member points
                                        </button>
                                    </td>
                                </ng-container>
                            </ng-container>


                            <tr mat-header-row
                                *matHeaderRowDef="recentPointsTableColumns"></tr>
                            <tr class="order-row h-16"
                                mat-row
                                *matRowDef="let row; columns: recentPointsTableColumns;"></tr>
                            <tr class="h-16 border-0"
                                mat-footer-row
                                *matFooterRowDef="['recentPointsTableFooter']"></tr>
                        </table>
                    </div>
                </div>

                <!-- Recent transactions table -->
                <div class="col-span-2 flex flex-col flex-auto bg-card shadow rounded-2xl overflow-hidden">
                    <div class="p-6">
                        <div class="mr-4 text-lg font-medium tracking-tight leading-6 truncate">Recent transactions</div>
                        <!-- <div class="text-secondary font-medium">1 pending, 4 completed</div> -->
                    </div>
                    <div class="overflow-x-auto mx-6">
                        <table class="w-full bg-transparent"
                               mat-table
                               matSort
                               [dataSource]="recentTransactionsDataSource"
                               [trackBy]="trackByFn"
                               #recentTransactionsTable>

                            <!-- Transaction ID -->
                            <ng-container matColumnDef="document_no">
                                <th mat-header-cell
                                    mat-sort-header
                                    *matHeaderCellDef style="background:#e2e8f0;">
                                    Order No.
                                </th>
                                <ng-container mat-cell *matCellDef="let transaction">
                                    <ng-container *ngIf="transaction.point_type != 'adjustment'">
                                        <td mat-cell [routerLink]="['./transaction', transaction.id]" style="cursor:pointer;">
                                            <span class="pr-6 font-medium text-sm text-secondary whitespace-nowrap">
                                                {{transaction.document_no}}
                                            </span>
                                        </td>
                                    </ng-container>
                                    <ng-container *ngIf="transaction.point_type == 'adjustment'">
                                        <td mat-cell>
                                            <span class="pr-6 font-medium text-sm text-secondary whitespace-nowrap">
                                                {{transaction.document_no}}
                                            </span>
                                        </td>
                                    </ng-container>
                                </ng-container>

                            </ng-container>

                            <!-- Amount -->
                            <ng-container matColumnDef="total_amount">
                                <th mat-header-cell
                                    mat-sort-header
                                    *matHeaderCellDef style="background:#e2e8f0;">
                                    Amount
                                </th>
                                <ng-container mat-cell *matCellDef="let transaction">
                                    <ng-container *ngIf="transaction.point_type != 'adjustment'">
                                        <td mat-cell [routerLink]="['./transaction', transaction.id]" style="cursor:pointer;">
                                            <span class="pr-6 font-medium whitespace-nowrap">
                                                ${{transaction.total_amount| number : '1.2-2'}}
                                            </span>
                                        </td>
                                    </ng-container>
                                    <ng-container *ngIf="transaction.point_type == 'adjustment'">
                                        <td mat-cell>
                                            <span class="pr-6 font-medium whitespace-nowrap">
                                                ${{transaction.total_amount| number : '1.2-2'}}
                                            </span>
                                        </td>
                                    </ng-container>
                                </ng-container>

                            </ng-container>

                            <!-- Name -->
                            <ng-container matColumnDef="channel_name">
                                <th mat-header-cell
                                    mat-sort-header
                                    *matHeaderCellDef style="background:#e2e8f0;">
                                    Channel
                                </th>
                                <ng-container mat-cell *matCellDef="let transaction">
                                    <ng-container *ngIf="transaction.point_type != 'adjustment'">
                                        <td mat-cell [routerLink]="['./transaction', transaction.id]" style="cursor:pointer;">
                                            <ng-container *ngIf="transaction.transaction_channel != null">
                                                <span class="pr-6 whitespace-nowrap">
                                                    {{transaction.transaction_channel.name}}
                                                </span>
                                            </ng-container>
                                            <ng-container *ngIf="transaction.transaction_channel == null">
                                                <span class="pr-6 whitespace-nowrap">
                                                    -
                                                </span>
                                            </ng-container>
                                        </td>
                                    </ng-container>
                                    <ng-container *ngIf="transaction.point_type == 'adjustment'">
                                        <td mat-cell>
                                            <ng-container *ngIf="transaction.transaction_channel != null">
                                                <span class="pr-6 whitespace-nowrap">
                                                    {{transaction.transaction_channel.name}}
                                                </span>
                                            </ng-container>
                                            <ng-container *ngIf="transaction.transaction_channel == null">
                                                <span class="pr-6 whitespace-nowrap">
                                                    -
                                                </span>
                                            </ng-container>
                                        </td>
                                    </ng-container>
                                </ng-container>

                            </ng-container>

                            <!-- Points -->
                            <ng-container matColumnDef="point">
                                <th mat-header-cell
                                    mat-sort-header
                                    *matHeaderCellDef style="background:#e2e8f0;">
                                    Points
                                </th>
                                <ng-container mat-cell *matCellDef="let transaction">
                                    <ng-container *ngIf="transaction.point_type != 'adjustment'">
                                        <td mat-cell [routerLink]="['./transaction', transaction.id]" style="cursor:pointer;">
                                            <span class="pr-6 whitespace-nowrap">
                                                {{transaction.point}}
                                            </span>
                                        </td>
                                    </ng-container>
                                    <ng-container *ngIf="transaction.point_type == 'adjustment'">
                                        <td mat-cell>
                                            <span class="pr-6 whitespace-nowrap">
                                                {{transaction.point}}
                                            </span>
                                        </td>
                                    </ng-container>
                                </ng-container>

                            </ng-container>

                            <!-- $ Value -->
                            <ng-container matColumnDef="point_amount">
                                <th mat-header-cell
                                    mat-sort-header
                                    *matHeaderCellDef style="background:#e2e8f0;">
                                    $ Value
                                </th>
                                <ng-container mat-cell *matCellDef="let transaction">
                                    <ng-container *ngIf="transaction.point_type != 'adjustment'">
                                        <td mat-cell [routerLink]="['./transaction', transaction.id]" style="cursor:pointer;">
                                            <span class="pr-6 whitespace-nowrap">
                                                ${{transaction.point_amount | number : '1.2-2'}}
                                            </span>
                                        </td>
                                    </ng-container>
                                    <ng-container *ngIf="transaction.point_type == 'adjustment'">
                                        <td mat-cell>
                                            <span class="pr-6 whitespace-nowrap">
                                                ${{transaction.point_amount | number : '1.2-2'}}
                                            </span>
                                        </td>
                                    </ng-container>
                                </ng-container>

                            </ng-container>

                            <!-- Point Type -->
                            <ng-container matColumnDef="point_type">
                                <th mat-header-cell
                                    mat-sort-header
                                    *matHeaderCellDef style="background:#e2e8f0;">
                                    Point Type
                                </th>
                                <ng-container mat-cell *matCellDef="let transaction">
                                    <ng-container *ngIf="transaction.point_type != 'adjustment'">
                                        <td mat-cell [routerLink]="['./transaction', transaction.id]" style="cursor:pointer;">
                                            <span class="pr-6 whitespace-nowrap" style="text-transform:capitalize;">
                                                {{transaction.point_type}}
                                            </span>
                                        </td>
                                    </ng-container>
                                    <ng-container *ngIf="transaction.point_type == 'adjustment'">
                                        <td mat-cell>
                                            <span class="pr-6 whitespace-nowrap" style="text-transform:capitalize;">
                                                {{transaction.point_type}}
                                            </span>
                                        </td>
                                    </ng-container>
                                </ng-container>
                            </ng-container>

                            <!-- Date -->
                            <ng-container matColumnDef="purchase_date">
                                <th mat-header-cell
                                    mat-sort-header
                                    *matHeaderCellDef style="background:#e2e8f0;">
                                    Date
                                </th>
                                <ng-container mat-cell *matCellDef="let transaction">
                                    <ng-container *ngIf="transaction.point_type != 'adjustment'">
                                        <td mat-cell [routerLink]="['./transaction', transaction.id]" style="cursor:pointer;">
                                            <span class="pr-6 whitespace-nowrap">
                                                {{transaction.purchase_date | date:'MMM dd, y'}}
                                            </span>
                                        </td>
                                    </ng-container>
                                    <ng-container *ngIf="transaction.point_type == 'adjustment'">
                                        <td mat-cell>
                                            <span class="pr-6 whitespace-nowrap">
                                                {{transaction.purchase_date | date:'MMM dd, y'}}
                                            </span>
                                        </td>
                                    </ng-container>
                                </ng-container>

                            </ng-container>

                            <!-- Footer -->

                            <ng-container *ngIf="transactions.length > 0">
                                <ng-container matColumnDef="recentTransactionsTableFooter">
                                    <td class="py-6 px-0 border-0"
                                        mat-footer-cell
                                        *matFooterCellDef
                                        colspan="6">
                                        <button mat-stroked-button [routerLink]="['./transaction']">See all transactions</button>
                                    </td>
                                </ng-container>
                            </ng-container>

                            <ng-container *ngIf="transactions.length == 0">
                                <ng-container matColumnDef="recentTransactionsTableFooter">
                                    <td class="py-6 px-0 border-0"
                                        mat-footer-cell
                                        *matFooterCellDef
                                        colspan="6"
                                        style="color:grey;">
                                        No Transaction
                                    </td>
                                </ng-container>
                            </ng-container>


                            <tr mat-header-row
                                *matHeaderRowDef="recentTransactionsTableColumns"></tr>
                            <tr class="order-row h-16"
                                mat-row
                                *matRowDef="let row; columns: recentTransactionsTableColumns;"></tr>
                            <tr class="h-16 border-0"
                                mat-footer-row
                                *matFooterRowDef="['recentTransactionsTableFooter']"></tr>
                        </table>
                    </div>
                </div>
            </div>

        </div>
    </ng-container>

    <!-- Edit mode -->
    <ng-container *ngIf="editMode">
        <!-- Header -->
        <div class="relative w-full h-20 sm:h-20 px-8 sm:px-12 bg-accent-100 dark:bg-accent-700" style="position: sticky !important;top: 0;z-index: 99;">
            <!-- Close button -->
            <div class="flex items-center justify-end w-full max-w-3xl mx-auto pt-3">
                <div class="mt-3 text-4xl w-full font-bold truncate">Edit Member Information</div>
                <button mat-icon-button style="background: #ccc;"
                        [matTooltip]="'Close'"
                        (click)="toggleEditMode(false)">
                    <mat-icon class="text-white"
                              [svgIcon]="'heroicons_outline:x'"></mat-icon>
                </button>
            </div>
        </div>

        <!-- member form -->
        <div class="relative flex flex-col flex-auto items-center px-6 sm:px-12">
            <div class="w-full max-w-3xl">
                <!-- Alert -->
                <fuse-alert class="mt-8 -mb-4"
                            *ngIf="showAlert"
                            [appearance]="'outline'"
                            [showIcon]="false"
                            [type]="alert.type"
                            [@shake]="alert.type === 'error'">
                    {{alert.message}}
                </fuse-alert>
                <form [formGroup]="memberForm">
                    <!-- hidden Id -->
                    <div class="mt-8 hidden">
                        <mat-form-field class="fuse-mat-no-subscript w-full">
                            <input matInput
                                   [formControlName]="'id'">
                        </mat-form-field>
                    </div>

                    <!-- Name -->
                    <div class="mt-8">
                        <mat-form-field class="fuse-mat-no-subscript w-full">
                            <mat-label>First Name</mat-label>
                            <mat-icon matPrefix
                                      class="hidden sm:flex icon-size-5"
                                      [svgIcon]="'heroicons_solid:user-circle'"></mat-icon>
                            <input matInput
                                   [formControlName]="'first_name'"
                                   [placeholder]="'First Name'"
                                   [spellcheck]="false">
                        </mat-form-field>
                    </div>

                    <!-- Name -->
                    <div class="mt-8">
                        <mat-form-field class="fuse-mat-no-subscript w-full">
                            <mat-label>Last Name</mat-label>
                            <mat-icon matPrefix
                                      class="hidden sm:flex icon-size-5"
                                      [svgIcon]="'heroicons_solid:user-circle'"></mat-icon>
                            <input matInput
                                   [formControlName]="'last_name'"
                                   [placeholder]="'Last Name'"
                                   [spellcheck]="false">
                        </mat-form-field>
                    </div>

                    <!-- Phone numbers -->
                    <div class="mt-8">
                        <mat-form-field class="fuse-mat-no-subscript w-full">
                            <mat-label>Mobile Phone</mat-label>
                            <mat-icon matPrefix
                                      class="hidden sm:flex icon-size-5"
                                      [svgIcon]="'heroicons_outline:phone'"></mat-icon>
                            <input matInput
                                   [formControlName]="'mobile_phone'"
                                   [placeholder]="'Mobile'">
                        </mat-form-field>
                        <ng-container *ngIf="!phoneValidateError">
                            <mat-error>
                                Phone number already exit
                            </mat-error>
                        </ng-container>
                    </div>

                    <!-- Birthday -->
                    <div class="mt-8">
                        <mat-form-field class="fuse-mat-no-subscript w-full">
                            <mat-label>Birthday</mat-label>
                            <mat-icon matPrefix
                                      class="hidden sm:flex icon-size-5"
                                      [svgIcon]="'heroicons_solid:cake'"></mat-icon>
                            <input matInput
                                   [matDatepicker]="birthdayDatepicker"
                                   [formControlName]="'date_of_birth'"
                                   [placeholder]="'Birthday'">
                            <mat-datepicker-toggle matSuffix
                                                   [for]="birthdayDatepicker">
                            </mat-datepicker-toggle>
                            <mat-datepicker #birthdayDatepicker></mat-datepicker>
                        </mat-form-field>
                    </div>
                    
                    <!-- Gender -->
                    <div class="mt-8">
                        <mat-form-field class="fuse-mat-no-subscript w-full">
                            <mat-label>Gender</mat-label>
                            <mat-select [formControlName]="'gender'">
                                <mat-option value="male">Male</mat-option>
                                <mat-option value="female">Female</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <!-- Add Allow E-mail -->
                    <div class="mt-8">
                        <mat-form-field class="fuse-mat-no-subscript w-full">
                            <mat-label>Allow Email</mat-label>
                            <mat-select [formControlName]="'accept_email'">
                                <mat-option value="true">Yes</mat-option>
                                <mat-option value="false">No</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <!-- Add Allow SMS -->
                    <div class="mt-8">
                        <mat-form-field class="fuse-mat-no-subscript w-full">
                            <mat-label>Allow SMS</mat-label>
                            <mat-select [formControlName]="'accept_mobile_sms'">
                                <mat-option value="true">Yes</mat-option>
                                <mat-option value="false">No</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <!-- Member Tier -->
                    <ng-container *ngIf="isManagerRole">
                        <div class="mt-8">
                            <mat-form-field class="fuse-mat-no-subscript w-full">
                                <mat-label>Member Tier</mat-label>
                                <mat-select [formControlName]="'member_tier'">
                                    <ng-container *ngFor="let tier of memberTiers">
                                        <mat-option [value]="tier.id">
                                            {{tier.name}}
                                        </mat-option>
                                    </ng-container>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </ng-container>

                    <ng-container *ngIf="!isManagerRole">
                        <div class="mt-8 hidden">
                            <mat-form-field class="fuse-mat-no-subscript w-full">
                                <mat-label>Member Tier</mat-label>
                                <input matInput
                                       [formControlName]="'member_tier'">
                            </mat-form-field>
                        </div>
                    </ng-container>
                    

                    <!--<div class="flex sm:items-center mt-4">
                        <div class="w-full text-3xl font-bold">Address Information</div>
                    </div>

                   
                    <div class="mt-8">
                        <mat-form-field class="fuse-mat-no-subscript w-full">
                            <mat-label>Address 1</mat-label>
                            <mat-icon matPrefix
                                      class="hidden sm:flex icon-size-5"
                                      [svgIcon]="'heroicons_solid:location-marker'"></mat-icon>
                            <input matInput
                                   [formControlName]="'address_line_1'"
                                   [placeholder]="'Address 1'">
                        </mat-form-field>
                    </div>
                    <div class="mt-8">
                        <mat-form-field class="fuse-mat-no-subscript w-full">
                            <mat-label>Address 2</mat-label>
                            <mat-icon matPrefix
                                      class="hidden sm:flex icon-size-5"
                                      [svgIcon]="'heroicons_solid:location-marker'"></mat-icon>
                            <input matInput
                                   [formControlName]="'address_line_2'"
                                   [placeholder]="'Address 2'">
                        </mat-form-field>
                    </div>

                  
                    <div class="mt-8">
                        <mat-form-field class="fuse-mat-no-subscript w-full">
                            <mat-label>Postal Code</mat-label>
                            <mat-icon matPrefix
                                      class="hidden sm:flex icon-size-5"
                                      [svgIcon]="'heroicons_solid:location-marker'"></mat-icon>
                            <input matInput
                                   [formControlName]="'postal_code'"
                                   [placeholder]="'Postal Code'">
                        </mat-form-field>
                    </div>

                  
                    <div class="mt-8">
                        <mat-form-field class="fuse-mat-no-subscript w-full">
                            <mat-label>City</mat-label>
                            <mat-icon matPrefix
                                      class="hidden sm:flex icon-size-5"
                                      [svgIcon]="'heroicons_solid:location-marker'"></mat-icon>
                            <input matInput
                                   [formControlName]="'city'"
                                   [placeholder]="'City'">
                        </mat-form-field>
                    </div>-->

                   
                    <div class="flex items-center mt-10 -mx-6 sm:-mx-12 py-4 pr-4 pl-1 sm:pr-12 sm:pl-7 border-t bg-gray-50 dark:bg-transparent">
                        <button class="ml-2"
                                mat-flat-button
                                [color]="'primary'"
                                [disabled]="memberForm.invalid"
                                [matTooltip]="'Save'"
                                (click)="updateMember()">
                            Save
                        </button>
                    </div>

                </form>
            </div>
        </div>
    </ng-container>

</div>
